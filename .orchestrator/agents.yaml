# Orchestrator Agent Configuration
# Using proposal-driven model (v2)

model: proposal
paused: true  # System-wide pause - no agents will be spawned

# Proposal backpressure (per proposer type)
proposal_limits:
  test-checker:
    max_active: 5
    max_per_run: 2
  architect:
    max_active: 3
    max_per_run: 1
  plan-reader:
    max_active: 10
    max_per_run: 3
  backlog-groomer:
    max_active: 10
    max_per_run: 5
  inbox-poller:
    max_active: 1  # Only one item type at a time
    max_per_run: 10  # Process many items per run

# Voice weights - how much each proposer's voice matters
voice_weights:
  backlog-groomer: 1.5  # Processes user's direct input
  plan-reader: 1.5      # Executing documented plans is priority
  architect: 1.2        # Complexity reduction multiplies velocity
  test-checker: 1.0     # Important but often not urgent

# Task queue limits
queue_limits:
  max_incoming: 20
  max_claimed: 5
  max_open_prs: 10

# Agent definitions
agents:
  # ============================================
  # FAST POLL + PRE-CHECK (respond quickly to new work)
  # ============================================

  # Inbox Poller - classifies and routes inbox items
  - name: inbox-poller
    role: proposer
    focus: inbox_triage
    interval_seconds: 10  # Very frequent
    pre_check: "ls -A inbox/ 2>/dev/null | grep -v .gitkeep | head -1"
    pre_check_trigger: non_empty

  # Curator - evaluates proposals, queues tasks
  - name: curator
    role: curator
    interval_seconds: 30  # Frequent
    pre_check: "ls -A .orchestrator/shared/proposals/active/ 2>/dev/null | grep -v .gitkeep | head -1"
    pre_check_trigger: non_empty

  # Implementer - executes tasks
  - name: impl-agent-1
    role: implementer
    interval_seconds: 30  # Frequent
    pre_check: "ls -A .orchestrator/shared/queue/incoming/ 2>/dev/null | grep -v .gitkeep | head -1"
    pre_check_trigger: non_empty

  # ============================================
  # SLOW POLL (expensive work, no pre-check)
  # ============================================

  # Backlog Groomer - processes docs into proposals
  - name: backlog-groomer
    role: proposer
    focus: backlog_grooming
    interval_seconds: 86400  # Daily

  # Proposers - explore codebase, suggest work
  - name: test-checker
    role: proposer
    focus: test_quality
    interval_seconds: 86400  # Daily

  - name: architect
    role: proposer
    focus: code_structure
    interval_seconds: 86400  # Daily

  - name: plan-reader
    role: proposer
    focus: project_plans
    interval_seconds: 86400  # Daily

  # ============================================
  # ADDITIONAL AGENTS (uncomment to enable)
  # ============================================

  # - name: impl-agent-2
  #   role: implementer
  #   interval_seconds: 30
  #   pre_check: "ls -A .orchestrator/shared/queue/incoming/ 2>/dev/null | grep -v .gitkeep | head -1"
  #   pre_check_trigger: non_empty

  # - name: test-agent
  #   role: tester
  #   interval_seconds: 120

  # - name: review-agent
  #   role: reviewer
  #   interval_seconds: 300
